<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux系统常见的压缩打包指令 | LUG @ LIT</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/64x64.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/logo.png">
    <link rel="alternate" type="application/rss+xml" href="https://www.litunix.org/rss.xml" title="LUG @ LIT RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://www.litunix.org/feed.atom" title="LUG @ LIT Atom Feed">
    <link rel="alternate" type="application/json" href="https://www.litunix.org/feed.json" title="LUG @ LIT JSON Feed">
    <meta name="description" content="Luoyang Institute of Science and Technology Linux User Group">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/img/128x128.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.4346b530.css" as="style"><link rel="preload" href="/assets/js/app.eb45f07c.js" as="script"><link rel="preload" href="/assets/js/2.efe0c9c4.js" as="script"><link rel="preload" href="/assets/js/3.357157f6.js" as="script"><link rel="preload" href="/assets/js/11.9e6b244e.js" as="script"><link rel="preload" href="/assets/js/4.209f699a.js" as="script"><link rel="prefetch" href="/assets/js/10.4ded560c.js"><link rel="prefetch" href="/assets/js/12.60241502.js"><link rel="prefetch" href="/assets/js/13.d1905145.js"><link rel="prefetch" href="/assets/js/14.1627631d.js"><link rel="prefetch" href="/assets/js/15.347fe2fe.js"><link rel="prefetch" href="/assets/js/16.6af0718c.js"><link rel="prefetch" href="/assets/js/17.00fdd854.js"><link rel="prefetch" href="/assets/js/18.0ef0c3e5.js"><link rel="prefetch" href="/assets/js/19.500f8929.js"><link rel="prefetch" href="/assets/js/20.da5a7f33.js"><link rel="prefetch" href="/assets/js/21.540d9131.js"><link rel="prefetch" href="/assets/js/22.1e72f334.js"><link rel="prefetch" href="/assets/js/23.dac016bc.js"><link rel="prefetch" href="/assets/js/24.78d6507b.js"><link rel="prefetch" href="/assets/js/25.192144d1.js"><link rel="prefetch" href="/assets/js/26.93f76f64.js"><link rel="prefetch" href="/assets/js/27.97899f5d.js"><link rel="prefetch" href="/assets/js/28.d24ce5b0.js"><link rel="prefetch" href="/assets/js/29.39513b35.js"><link rel="prefetch" href="/assets/js/30.32db246e.js"><link rel="prefetch" href="/assets/js/31.6c404410.js"><link rel="prefetch" href="/assets/js/32.0c968a1c.js"><link rel="prefetch" href="/assets/js/5.1ee6cfff.js"><link rel="prefetch" href="/assets/js/6.e704bee2.js"><link rel="prefetch" href="/assets/js/7.a60e5423.js"><link rel="prefetch" href="/assets/js/8.e6dd431b.js"><link rel="prefetch" href="/assets/js/9.ffcf4554.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4346b530.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://image.gaoajia.com/2021/10/28/d7b19b2e89822.png" alt="LUG @ LIT" class="logo"> <span class="site-name can-hide">LUG @ LIT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/pages/c7906c/" class="nav-link">wiki</a></div><div class="nav-item"><a href="/" class="nav-link">Mirrors</a></div><div class="nav-item"><a href="/pages/about/" class="nav-link">About</a></div> <a href="https://github.com/lit-lug/homepage" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/pages/c7906c/" class="nav-link">wiki</a></div><div class="nav-item"><a href="/" class="nav-link">Mirrors</a></div><div class="nav-item"><a href="/pages/about/" class="nav-link">About</a></div> <a href="https://github.com/lit-lug/homepage" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开源理念</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/faf39d/" class="sidebar-link">何为开源?</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>shell相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/eb5b06/" class="sidebar-link">何为shell？</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Linux相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a91214/" aria-current="page" class="active sidebar-link">Linux系统常见的压缩打包指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/a91214/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header level2"><a href="/pages/a91214/#gzip-zcat-zmore-zless-zgrep" class="sidebar-link">gzip, zcat/zmore/zless/zgrep</a></li><li class="sidebar-sub-header level2"><a href="/pages/a91214/#bzip2-bzcat-bzmore-bzless-bzgrep" class="sidebar-link">bzip2, bzcat/bzmore/bzless/bzgrep</a></li><li class="sidebar-sub-header level2"><a href="/pages/a91214/#xz-xzcat-xzmore-xzless-xzgrep" class="sidebar-link">xz, xzcat/xzmore/xzless/xzgrep</a></li><li class="sidebar-sub-header level2"><a href="/pages/a91214/#tar" class="sidebar-link">tar</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux黑话解释</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9a27d2/" class="sidebar-link">Linux 黑话解释：什么是上游和下游？</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-21568009><div class="articleInfo" data-v-21568009><ul class="breadcrumbs" data-v-21568009><li data-v-21568009><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-21568009></a></li> <li data-v-21568009><a href="/categories/?category=Blog" title="分类" data-v-21568009>Blog</a></li><li data-v-21568009><a href="/categories/?category=Linux%E7%9B%B8%E5%85%B3" title="分类" data-v-21568009>Linux相关</a></li></ul> <div class="info" data-v-21568009><div title="作者" class="author iconfont icon-touxiang" data-v-21568009><a href="https://www.gaoajia.com" target="_blank" title="作者" class="beLink" data-v-21568009>Ajia Erin</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-21568009><a href="javascript:;" data-v-21568009>2022-01-22</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Linux系统常见的压缩打包指令<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="压缩指令"><a href="#压缩指令" class="header-anchor">#</a> 压缩指令</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>在Linux的环境中，压缩文件的扩展名大多是：<code>*.tar</code>, <code>*.tar.gz</code>, <code>*.tgz</code>, <code>*.gz</code>, <code>*.Z</code>, <code>*.bz2</code>, <code>*.xz</code>，为什么会有这样的扩展名呢？不是说 Linux 的扩展名没有什么作用吗？</p> <p>这是因为 Linux 支持的压缩指令非常多，且不同的指令所用的压缩技术并不相同，当然彼此之间可能就无法互通压缩/解压缩文件啰。 所以，当你下载到某个压缩文件时，自然就需要知道该文件是由哪种压缩指令所制作出来的，好用来对照着解压缩啊！</p> <p>也就是说，虽然 Linux 文件的属性基本上是与文件名没有绝对关系的， 但是为了帮助我们人类小小的脑袋瓜子，所以适当的扩展名还是必要的！ 下面我们就列出几个常见的压缩文件扩展名吧：</p> <table><thead><tr><th style="text-align:center;">扩展名</th> <th style="text-align:center;">说明</th></tr></thead> <tbody><tr><td style="text-align:center;">*.Z</td> <td style="text-align:center;">compress 程序压缩的文件；</td></tr> <tr><td style="text-align:center;">*.zip</td> <td style="text-align:center;">zip 程序压缩的文件；</td></tr> <tr><td style="text-align:center;">*.gz</td> <td style="text-align:center;">gzip 程序压缩的文件；</td></tr> <tr><td style="text-align:center;">*.bz2</td> <td style="text-align:center;">bzip2 程序压缩的文件；</td></tr> <tr><td style="text-align:center;">*.xz</td> <td style="text-align:center;">xz 程序压缩的文件；</td></tr> <tr><td style="text-align:center;">*.tar</td> <td style="text-align:center;">tar 程序打包的数据，并没有压缩过；</td></tr> <tr><td style="text-align:center;">*.tar.gz</td> <td style="text-align:center;">tar 程序打包的文件，其中并且经过 gzip 的压缩</td></tr> <tr><td style="text-align:center;">*.tar.bz2</td> <td style="text-align:center;">tar 程序打包的文件，其中并且经过 bzip2 的压缩</td></tr> <tr><td style="text-align:center;">*.tar.xz</td> <td style="text-align:center;">tar 程序打包的文件，其中并且经过 xz 的压缩</td></tr></tbody></table> <p>Linux上常见的压缩指令就是 gzip, bzip2 以及最新的 xz ，至于 compress 已经退流行了。为了支持 windows 常见的 zip，其实 Linux 也早就有 zip 指令了！ gzip 是由 GNU 计划所开发出来的压缩指令，该指令已经取代了 compress 。 后来 GNU 又开发出 bzip2 及 xz 这几个压缩比更好的压缩指令！不过，这些指令通常仅能针对一个文件来压缩与解压缩，如此一来， 每次压缩与解压缩都要一大堆文件，岂不烦人？此时，那个所谓的“打包软件, tar”就显的很重要啦！</p> <p>这个 tar 可以将很多文件“打包”成为一个文件！甚至是目录也可以这么玩。不过，单纯的 tar 功能仅是“打包”而已，亦即是将很多文件集结成为一个文件， 事实上，他并没有提供压缩的功能，后来，GNU 计划中，将整个 tar 与压缩的功能结合在一起，如此一来提供使用者更方便并且更强大的压缩与打包功能！ 下面我们就来谈一谈这些在 Linux 下面基本的压缩指令吧！</p> <h2 id="gzip-zcat-zmore-zless-zgrep"><a href="#gzip-zcat-zmore-zless-zgrep" class="header-anchor">#</a> gzip, zcat/zmore/zless/zgrep</h2> <p>gzip 可以说是应用度最广的压缩指令了！目前 gzip 可以解开 compress, zip 与 gzip 等软件所压缩的文件。 至于 gzip 所创建的压缩文件为 *.gz 的文件名喔！让我们来看看这个指令的语法吧：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ <span class="token function">gzip</span> <span class="token punctuation">[</span>-cdtv<span class="token comment">#] 文件名</span>
<span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ zcat 文件名.gz
选项与参数：
-c  ：将压缩的数据输出到屏幕上，可通过数据流重导向来处理；
-d  ：解压缩的参数；
-t  ：可以用来检验一个压缩文件的一致性～看看文件有无错误；
-v  ：可以显示出原文件/压缩文件的压缩比等信息；
-<span class="token comment">#  ：# 为数字的意思，代表压缩等级，-1 最快，但是压缩比最差、-9 最慢，但是压缩比最好！默认是 -6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例一</p> <p>找出 /etc 下面 （不含子目录） 容量最大的文件，并将它复制到 /tmp ，然后以 gzip 压缩</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ <span class="token function">ls</span> -ldSr /etc/*   <span class="token comment"># 忘记选项意义？请自行 man 啰！</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.（前面省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>.
-rw-r--r--.  <span class="token number">1</span> root root    <span class="token number">25213</span> Jun <span class="token number">10</span>  <span class="token number">2014</span> /etc/dnsmasq.conf
-rw-r--r--.  <span class="token number">1</span> root root    <span class="token number">69768</span> May  <span class="token number">4</span> <span class="token number">17</span>:55 /etc/ld.so.cache
-rw-r--r--.  <span class="token number">1</span> root root   <span class="token number">670293</span> Jun  <span class="token number">7</span>  <span class="token number">2013</span> /etc/services

<span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">cd</span> /tmp 
<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">cp</span> /etc/services <span class="token builtin class-name">.</span>
<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">gzip</span> -v services
services:        <span class="token number">79.7</span>% -- replaced with services.gz
<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ ll /etc/services /tmp/services*
-rw-r--r--. <span class="token number">1</span> root   root   <span class="token number">670293</span> Jun  <span class="token number">7</span>  <span class="token number">2013</span> /etc/services
-rw-r--r--. <span class="token number">1</span> dmtsai dmtsai <span class="token number">136088</span> Jun <span class="token number">30</span> <span class="token number">18</span>:40 /tmp/services.gz

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>当你使用 gzip 进行压缩时，在默认的状态下原本的文件会被压缩成为 .gz 的文件名，原始文件就不再存在了。 这点与一般习惯使用 windows 做压缩的朋友所熟悉的情况不同喔！要注意！要注意！ 至于其他的用法如下：</p> <div class="custom-block tip"><p class="custom-block-title">范例二</p> <p>由于 services 是文本文件，请将范例一的压缩文件的内容读出来！</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ zcat services.gz
<span class="token comment"># 由于 services 这个原本的文件是是文本文件，因此我们可以尝试使用 zcat/zmore/zless 去读取！</span>
<span class="token comment"># 此时屏幕上会显示 servcies.gz 解压缩之后的原始文件内容！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例三</p> <p>将范例一的文件解压缩</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">gzip</span> -d services.gz
<span class="token comment"># 不要使用 gunzip 这个指令，不好背！使用 gzip -d 来进行解压缩！</span>
<span class="token comment"># 与 gzip 相反， gzip -d 会将原本的 .gz 删除，回复到原本的 services 文件。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例四</p> <p>将范例三解开的 services 用最佳的压缩比压缩，并保留原本的文件</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">gzip</span> -9 -c services <span class="token operator">&gt;</span> services.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>:::范例五
由范例四再次创建的 services.gz 中，找出 http 这个关键字在哪几行？
:::</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ zgrep -n <span class="token string">'http'</span> services.gz
<span class="token number">14</span>:<span class="token comment">#       http://www.iana.org/assignments/port-numbers</span>
<span class="token number">89</span>:http            <span class="token number">80</span>/tcp          www www-http    <span class="token comment"># WorldWideWeb HTTP</span>
<span class="token number">90</span>:http            <span class="token number">80</span>/udp          www www-http    <span class="token comment"># HyperText Transfer Protocol</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.（下面省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其实 gzip 的压缩已经最优化过了，所以虽然 gzip 提供 1~9 的压缩等级，不过使用默认的 6 就非常好用了！ 因此上述的范例四可以不要加入那个 -9 的选项。范例四的重点在那个 -c 与 &gt; 的使用啰！-c 可以将原本要转成压缩文件的数据内容，将它变成文字类型从屏幕输出， 然后我们可以通过大于 （&gt;） 这个符号，将原本应该由屏幕输出的数据，转成输出到文件而不是屏幕，所以就能够创建出压缩挡了。只是文件名也要自己写， 当然最好还是遵循 gzip 的压缩文件名要求较佳喔！！</p> <p>cat/more/less 可以使用不同的方式来读取纯文本文件，那个 zcat/zmore/zless 则可以对应于 cat/more/less 的方式来读取纯文本文件被压缩后的压缩文件！ 由于 gzip 这个压缩指令主要想要用来取代 compress 的，所以不但 compress 的压缩文件可以使用 gzip 来解开，同时 zcat 这个指令可以同时读取 compress 与 gzip 的压缩文件呦！</p> <p>另外，如果你还想要从文字压缩文件当中找数据的话，可以通过 egrep 来搜寻关键字喔！而不需要将压缩文件解开才以 grep 进行！ 这对查询备份中的文本文件数据相当有用！</p> <h2 id="bzip2-bzcat-bzmore-bzless-bzgrep"><a href="#bzip2-bzcat-bzmore-bzless-bzgrep" class="header-anchor">#</a> bzip2, bzcat/bzmore/bzless/bzgrep</h2> <p>若说 gzip 是为了取代 compress 并提供更好的压缩比而成立的，那么 bzip2 则是为了取代 gzip 并提供更佳的压缩比而来的。 bzip2 真是很不错用的东西～这玩意的压缩比竟然比 gzip 还要好～至于 bzip2 的用法几乎与 gzip 相同！看看下面的用法吧！</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ <span class="token function">bzip2</span> <span class="token punctuation">[</span>-cdkzv<span class="token comment">#] 文件名</span>
<span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ bzcat 文件名.bz2
选项与参数：
-c  ：将压缩的过程产生的数据输出到屏幕上！
-d  ：解压缩的参数
-k  ：保留原始文件，而不会删除原始的文件喔！
-z  ：压缩的参数 （默认值，可以不加）
-v  ：可以显示出原文件/压缩文件的压缩比等信息；
-<span class="token comment">#  ：与 gzip 同样的，都是在计算压缩比的参数， -9 最佳， -1 最快！</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例一</p> <p>将刚刚 gzip 范例留下来的 /tmp/services 以 bzip2 压缩</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">bzip2</span> -v services
  services:  <span class="token number">5.409</span>:1,  <span class="token number">1.479</span> bits/Byte, <span class="token number">81.51</span>% saved, <span class="token number">670293</span> in, <span class="token number">123932</span> out.
<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">ls</span> -l services*
-rw-r--r--. <span class="token number">1</span> dmtsai dmtsai <span class="token number">123932</span> Jun <span class="token number">30</span> <span class="token number">18</span>:40 services.bz2
-rw-rw-r--. <span class="token number">1</span> dmtsai dmtsai <span class="token number">135489</span> Jun <span class="token number">30</span> <span class="token number">18</span>:46 services.gz
<span class="token comment"># 此时 services 会变成 services.bz2 之外，你也可以发现 bzip2 的压缩比要较 gzip 好喔！！</span>
<span class="token comment"># 压缩率由 gzip 的 79% 提升到 bzip2 的 81% 哩！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例二</p> <p>将范例一的文件内容读出来！</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ bzcat services.bz2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例三</p> <p>将范例一的文件解压缩</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">bzip2</span> -d services.bz2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例四</p> <p>将范例三解开的 services 用最佳的压缩比压缩，并保留原本的文件</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">bzip2</span> -9 -c services <span class="token operator">&gt;</span> services.bz2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>看上面的范例，你会发现到 bzip2 连选项与参数都跟 gzip 一模一样！只是扩展名由 .gz 变成 .bz2 而已！其他的用法都大同小异，所以就不一一介绍了！ 你也可以发现到 bzip2 的压缩率确实比 gzip 要好些！不过，对于大容量文件来说，bzip2 压缩时间会花比较久喔！至少比 gzip 要久的多！ 这没办法～要有更多可用容量，就得要花费相对应的时间！还 OK 啊！</p> <h2 id="xz-xzcat-xzmore-xzless-xzgrep"><a href="#xz-xzcat-xzmore-xzless-xzgrep" class="header-anchor">#</a> xz, xzcat/xzmore/xzless/xzgrep</h2> <p>虽然 bzip2 已经具有很棒的压缩比，不过显然某些自由软件开发者还不满足，因此后来还推出了 xz 这个压缩比更高的软件！这个软件的用法也跟 gzip/bzip2 几乎一模一样！ 那我们就来瞧一瞧！</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ xz <span class="token punctuation">[</span>-dtlkc<span class="token comment">#] 文件名</span>
<span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ xcat 文件名.xz
选项与参数：
-d  ：就是解压缩啊！
-t  ：测试压缩文件的完整性，看有没有错误
-l  ：列出压缩文件的相关信息
-k  ：保留原本的文件不删除～
-c  ：同样的，就是将数据由屏幕上输出的意思！
-<span class="token comment">#  ：同样的，也有较佳的压缩比的意思！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例一</p> <p>将刚刚由 bzip2 所遗留下来的 /tmp/services 通过 xz 来压缩！</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ xz -v services
services （1/1）
  <span class="token number">100</span> %        <span class="token number">97.3</span> KiB / <span class="token number">654.6</span> KiB <span class="token operator">=</span> <span class="token number">0.149</span>

<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ <span class="token function">ls</span> -l services*
-rw-rw-r--. <span class="token number">1</span> dmtsai dmtsai <span class="token number">123932</span> Jun <span class="token number">30</span> <span class="token number">19</span>:09 services.bz2
-rw-rw-r--. <span class="token number">1</span> dmtsai dmtsai <span class="token number">135489</span> Jun <span class="token number">30</span> <span class="token number">18</span>:46 services.gz
-rw-r--r--. <span class="token number">1</span> dmtsai dmtsai  <span class="token number">99608</span> Jun <span class="token number">30</span> <span class="token number">18</span>:40 services.xz
<span class="token comment"># 各位观众！看到没有啊！！容量又进一步下降的更多耶！好棒的压缩比！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例二</p> <p>列出这个压缩文件的信息，然后读出这个压缩文件的内容</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ xz -l services.xz
Strms  Blocks   Compressed Uncompressed  Ratio  Check   Filename
    <span class="token number">1</span>       <span class="token number">1</span>     <span class="token number">97.3</span> KiB    <span class="token number">654.6</span> KiB  <span class="token number">0.149</span>  CRC64   services.xz
<span class="token comment"># 竟然可以列出这个文件的压缩前后的容量，真是太人性化了！这样观察就方便多了！</span>

<span class="token punctuation">[</span>dmtsai@study tmp<span class="token punctuation">]</span>$ xzcat services.xz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例三</p> <p>将他解压缩吧！</p></div> <div class="language- line-numbers-mode"><pre class="language-text"><code>[dmtsai@study tmp]$ xz -d services.xz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">范例四</p> <p>保留原文件的文件名，并且创建压缩文件！</p></div> <div class="language- line-numbers-mode"><pre class="language-text"><code>[dmtsai@study tmp]$ xz -k services
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>虽然 xz 这个压缩比真的好太多太多了！他可以将 gzip 压缩比 （压缩后/压缩前） 的 21% 更进一步优化到 15% 耶！ 差非常非常多！不过， xz 最大的问题是...时间花太久了！如果你曾经使用过 xz 的话，应该会有发现，他的运算时间真的比 gzip 久很多！所以，如果你并不觉得时间是你的成本考虑，那么使用 xz 会比较好！如果时间是你的重要成本，那么 gzip 恐怕是比较适合的压缩软件！</p> <h1 id="打包指令tar"><a href="#打包指令tar" class="header-anchor">#</a> 打包指令tar</h1> <p>前一小节谈到的指令大多仅能针对单一文件来进行压缩，虽然 gzip, bzip2, xz 也能够针对目录来进行压缩，不过， 这两个指令对目录的压缩指的是“将目录内的所有文件 &quot;分别&quot; 进行压缩”的动作！而不像在 Windows 的系统，可以使用类似 WinRAR 这一类的压缩软件来将好多数据“包成一个文件”的样式。</p> <p>这种将多个文件或目录包成一个大文件的指令功能，我们可以称呼他是一种“打包指令”啦！ 那 Linux 有没有这种打包指令呢？是有的！那就是鼎鼎大名的 tar 这个玩意儿了！ tar 可以将多个目录或文件打包成一个大文件，同时还可以通过 gzip/bzip2/xz 的支持，将该文件同时进行压缩！ 更有趣的是，由于 tar 的使用太广泛了，目前 Windows 的 WinRAR 也支持 .tar.gz 文件名的解压缩！ 很不错吧！</p> <h2 id="tar"><a href="#tar" class="header-anchor">#</a> tar</h2> <p>tar 的选项与参数非常的多！我们只讲几个常用的选项，更多选项您可以自行 man tar 查询啰！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[dmtsai@study ~]$ tar [-z|-j|-J] [cv] [-f 待创建的新文件名] filename... &lt;==打包与压缩
[dmtsai@study ~]$ tar [-z|-j|-J] [tv] [-f 既有的 tar文件名]             &lt;==察看文件名
[dmtsai@study ~]$ tar [-z|-j|-J] [xv] [-f 既有的 tar文件名] [-C 目录]   &lt;==解压缩
选项与参数：
-c  ：创建打包文件，可搭配 -v 来察看过程中被打包的文件名（filename）
-t  ：察看打包文件的内容含有哪些文件名，重点在察看“文件名”就是了；
-x  ：解打包或解压缩的功能，可以搭配 -C （大写） 在特定目录解开
      特别留意的是， -c, -t, -x 不可同时出现在一串命令行中。
-z  ：通过 gzip  的支持进行压缩/解压缩：此时文件名最好为 *.tar.gz
-j  ：通过 bzip2 的支持进行压缩/解压缩：此时文件名最好为 *.tar.bz2
-J  ：通过 xz    的支持进行压缩/解压缩：此时文件名最好为 *.tar.xz
      特别留意， -z, -j, -J 不可以同时出现在一串命令行中
-v  ：在压缩/解压缩的过程中，将正在处理的文件名显示出来！
-f filename：-f 后面要立刻接要被处理的文件名！建议 -f 单独写一个选项啰！（比较不会忘记）
-C 目录    ：这个选项用在解压缩，若要在特定目录解压缩，可以使用这个选项。

其他后续练习会使用到的选项介绍：
-p（小写） ：保留备份数据的原本权限与属性，常用于备份（-c）重要的配置文件
-P（大写） ：保留绝对路径，亦即允许备份数据中含有根目录存在之意；
--exclude=FILE：在压缩的过程中，不要将 FILE 打包！ 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>其实最简单的使用 tar 就只要记忆下面的方式即可：</p> <ul><li>压　缩：tar -jcv -f filename.tar.bz2 要被压缩的文件或目录名称</li> <li>查　询：tar -jtv -f filename.tar.bz2</li> <li>解压缩：tar -jxv -f filename.tar.bz2 -C 欲解压缩的目录</li></ul> <p>那个 <code>filename.tar.bz2</code> 是我们自己取的文件名，tar 并不会主动的产生创建的文件名喔！我们要自订啦！ 所以扩展名就显的很重要了！如果不加 [-z|-j|-J] 的话，文件名最好取为<code>*.tar</code>即可。如果是 -j 选项，代表有 bzip2 的支持，因此文件名最好就取为 <code>*.tar.bz2</code> ，因为 bzip2 会产生 .bz2 的扩展名之故！ 至于如果是加上了 -z 的 gzip 的支持，那文件名最好取为 <code>*.tar.gz</code>喔！</p> <p>另外，由于<code>-f filename</code>是紧接在一起的，过去很多文章常会写成<code>-jcvf filename</code>，这样是对的， 但由于选项的顺序理论上是可以变换的，所以很多读者会误认为<code>-jvfc filename</code>也可以～事实上这样会导致产生的文件名变成 c ！ 因为 -fc 嘛！所以啰，建议您在学习 tar 时，将<code>-f filename</code>与其他选项独立出来，会比较不容易发生问题。</p> <p>闲话少说，让我们来测试几个常用的 tar 方法吧！</p> <div class="custom-block tip"><p class="custom-block-title">范例一</p> <p>使用 tar 加入 -z, -j 或 -J 的参数备份 /etc/ 目录</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>dmtsai@study ~<span class="token punctuation">]</span>$ <span class="token function">su</span> -  <span class="token comment"># 因为备份 /etc 需要 root 的权限，否则会出现一堆错误</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># time tar -zpcv -f /root/etc.tar.gz /etc</span>
tar: Removing leading `/' from member names  <span class="token operator">&lt;=</span><span class="token operator">=</span>注意这个警告讯息
/etc/
<span class="token punctuation">..</span><span class="token punctuation">..</span>（中间省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>
/etc/hostname
/etc/aliases.db

real    0m0.799s   <span class="token comment"># 多了 time 会显示程序运行的时间！看 real 就好了！花去了 0.799s</span>
user    0m0.767s
sys     0m0.046s
<span class="token comment"># 由于加上 -v 这个选项，因此正在作用中的文件名就会显示在屏幕上。</span>
<span class="token comment"># 如果你可以翻到第一页，会发现出现上面的错误讯息！下面会讲解。</span>
<span class="token comment"># 至于 -p 的选项，重点在于“保留原本文件的权限与属性”之意。</span>

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># time tar -jpcv -f /root/etc.tar.bz2 /etc</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>（前面省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>
real    0m1.913s
user    0m1.881s
sys     0m0.038s
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># time tar -Jpcv -f /root/etc.tar.xz  /etc</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>（前面省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>
real    0m9.023s
user    0m8.984s
sys     0m0.086s
<span class="token comment"># 显示的讯息会跟上面一模一样啰！不过时间会花比较多！使用了 -J 时，会花更多时间</span>

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ll /root/etc*</span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">6721809</span> Jul  <span class="token number">1</span> 00:16 /root/etc.tar.bz2
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">7758826</span> Jul  <span class="token number">1</span> 00:14 /root/etc.tar.gz
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">5511500</span> Jul  <span class="token number">1</span> 00:16 /root/etc.tar.xz
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># du -sm /etc</span>
<span class="token number">28</span>     /etc  <span class="token comment"># 实际目录约占有 28MB 的意思！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>压缩比越好当然要花费的运算时间越多！我们从上面可以看到，虽然使用 gzip 的速度相当快，总时间花费不到 1 秒钟，但是压缩率最糟糕！ 如果使用 xz 的话，虽然压缩比最佳！不过竟然花了 9 秒钟的时间耶！这还仅是备份 28MBytes 的 /etc 而已，如果备份的数据是很大容量的， 那你真的要考虑时间成本才行！</p> <div class="custom-block tip"><p class="custom-block-title">范例二</p> <p>查阅 tar 文件的数据内容 （可察看文件名），与备份文件名有否根目录的意义</p></div> <p>要察看由 tar 所创建的打包文件内部的文件名非常的简单！可以这样做：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># tar -jtv -f /root/etc.tar.bz2</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>（前面省略）<span class="token punctuation">..</span><span class="token punctuation">..</span>
-rw-r--r-- root/root       <span class="token number">131</span> <span class="token number">2015</span>-05-25 <span class="token number">17</span>:48 etc/locale.conf
-rw-r--r-- root/root        <span class="token number">19</span> <span class="token number">2015</span>-05-04 <span class="token number">17</span>:56 etc/hostname
-rw-r--r-- root/root     <span class="token number">12288</span> <span class="token number">2015</span>-05-04 <span class="token number">17</span>:59 etc/aliases.db
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果加上 -v 这个选项时，详细的文件权限/属性都会被列出来！如果只是想要知道文件名而已， 那么就将 -v 拿掉即可。从上面的数据我们可以发现一件很有趣的事情，那就是每个文件名都没了根目录了！这也是上一个练习中出现的那个警告讯息“tar: Removing leading <code>/' from member names（移除了文件名开头的</code>/' ）”所告知的情况！</p> <p>那为什么要拿掉根目录呢？主要是为了安全！我们使用 tar 备份的数据可能会需要解压缩回来使用， 在 tar 所记录的文件名 （就是我们刚刚使用 tar -jtvf 所察看到的文件名） 那就是解压缩后的实际文件名。 如果拿掉了根目录，假设你将备份数据在 /tmp解开，那么解压缩的文件名就会变成“/tmp/etc/xxx”。 但“如果没有拿掉根目录，解压缩后的文件名就会是绝对路径， 亦即解压缩后的数据一定会被放置到 /etc/xxx 去！”如此一来，你的原本的 /etc/ 下面的数据， 就会被备份数据所覆盖过去了！</p> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>你会说：“既然是备份数据，那么还原回来也没有什么问题吧？”想像一个状况，你备份的数据是两年前的旧版 CentOS 6.x， 你只是想要了解一下过去的备份内容究竟有哪些数据而已，结果一解开该文件，却发现你目前新版的 CentOS 7.x 下面的 /etc 被旧版的备份数据覆盖了！此时你该如何是好？大概除了哭哭你也不能做啥事吧？所以啰，当然是拿掉根目录比较安全一些的。</p></div> <div class="custom-block tip"><p class="custom-block-title">范例三</p> <p>将备份的数据解压缩，并考虑特定目录的解压缩动作 （-C 选项的应用）</p></div> <p>那如果想要解打包呢？很简单的动作就是直接进行解打包嘛！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@study ~]# tar -jxv -f /root/etc.tar.bz2
[root@study ~]# ll
....（前面省略）....
drwxr-xr-x. 131 root root    8192 Jun 26 22:14 etc
....（后面省略）....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>此时该打包文件会在“本目录下进行解压缩”的动作！ 所以，你等一下就会在主文件夹下面发现一个名为 etc 的目录啰！所以啰，如果你想要将该文件在 /tmp 下面解开， 可以 cd /tmp 后，再下达上述的指令即可。不过，这样好像很麻烦呢～有没有更简单的方法可以“指定欲解开的目录”呢？ 有的，可以使用 -C 这个选项喔！举例来说：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@study ~]# tar -jxv -f /root/etc.tar.bz2 -C /tmp
[root@study ~]# ll /tmp
....（前面省略）....
drwxr-xr-x. 131 root   root     8192 Jun 26 22:14 etc
....（后面省略）....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这样一来，你就能够将该文件在不同的目录解开啰！鸟哥个人是认为，这个 -C 的选项务必要记忆一下的！ 好了，处理完毕后，请记得将这两个目录删除一下呢！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@study ~]# rm -rf /root/etc /tmp/etc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>再次强调，这个“ rm -rf ”是很危险的指令！下达时请务必要确认一下后面接的文件名。我们要删除的是 /root/etc 与 /tmp/etc， 您可不要将 /etc/ 删除掉了！系统会死掉的～</p> <div class="custom-block tip"><p class="custom-block-title">范例四</p> <p>仅解开单一文件的方法</p></div> <p>刚刚上头我们解压缩都是将整个打包文件的内容全部解开！想像一个情况，如果我只想要解开打包文件内的其中一个文件而已， 那该如何做呢？很简单的，你只要使用 -jtv 找到你要的文件名，然后将该文件名解开即可。 我们用下面的例子来说明一下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 1. 先找到我们要的文件名，假设解开 shadow 文件好了：
[root@study ~]# tar -jtv -f /root/etc.tar.bz2 | grep 'shadow'
---------- root/root       721 2015-06-17 00:20 etc/gshadow
---------- root/root      1183 2015-06-17 00:20 etc/shadow-
---------- root/root      1210 2015-06-17 00:20 etc/shadow  &lt;==这是我们要的！
---------- root/root       707 2015-06-17 00:20 etc/gshadow-
# 先搜寻重要的文件名！其中那个 grep 是“撷取”关键字的功能！我们会在第三篇说明！
# 这里您先有个概念即可！那个管线 | 配合 grep 可以撷取关键字的意思！

# 2. 将该文件解开！语法与实际作法如下：
[root@study ~]# tar -jxv -f 打包档.tar.bz2 待解开文件名
[root@study ~]# tar -jxv -f /root/etc.tar.bz2 etc/shadow
etc/shadow
[root@study ~]# ll etc
total 4
----------. 1 root root 1210 Jun 17 00:20 shadow
# 很有趣！此时只会解开一个文件而已！不过，重点是那个文件名！你要找到正确的文件名。
# 在本例中，你不能写成 /etc/shadow ！因为记录在 etc.tar.bz2 内的并没有 / 之故！
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=command" title="标签">#command</a></div> <div class="last-updated"><span class="prefix">Last Update:</span> <span class="time">2022/01/25, 19:11:13</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/eb5b06/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">何为shell？</div></a> <a href="/pages/9a27d2/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Linux 黑话解释：什么是上游和下游？</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/eb5b06/" class="prev">何为shell？</a></span> <span class="next"><a href="/pages/9a27d2/">Linux 黑话解释：什么是上游和下游？</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2949970175&amp;site=qq&amp;menu=yes" title="联系维护人员QQ" target="_blank" class="iconfont icon-QQ"></a><a href="mailto:icpove@litunix.org" title="意见反馈邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/lit-lug/homepage" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span><a href="https://iluoli.ren" target="_blank" title="LUG主页" >LIT LUG</a> | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.eb45f07c.js" defer></script><script src="/assets/js/2.efe0c9c4.js" defer></script><script src="/assets/js/3.357157f6.js" defer></script><script src="/assets/js/11.9e6b244e.js" defer></script><script src="/assets/js/4.209f699a.js" defer></script>
  </body>
</html>
